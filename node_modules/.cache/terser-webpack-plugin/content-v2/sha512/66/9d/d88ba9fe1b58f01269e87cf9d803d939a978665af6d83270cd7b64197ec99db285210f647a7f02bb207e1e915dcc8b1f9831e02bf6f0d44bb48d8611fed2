{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){e.exports=a(392)},193:function(e,t,a){},392:function(e,t,a){\"use strict\";a.r(t);var n=a(1),l=a.n(n),r=a(8),s=a.n(r),o=(a(192),a(193),a(194),a(184)),c=(a(130),a(45)),i=(a(83),a(34)),u=(a(166),a(37)),d=(a(131),a(27)),p=(a(132),a(36)),h=(a(106),a(29)),m=(a(393),a(104)),y=(a(167),a(79)),f=a(66),v=(a(206),a(183)),b=a(38),E=a(49),g=a(65),O=a(60),C=a(24),x=a(64),k=(a(208),a(81)),w=a(50),H=a.n(w),j=a(168),I=a.n(j),P=a(169),N=a.n(P),R=a(170),V=a.n(R),S=(a(394),a(182)),T=(a(237),a(180)),B=(a(239),a(10)),z=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(g.a)(this,Object(O.a)(t).call(this,e))).changeInputValue=a.changeInputValue.bind(Object(C.a)(a)),a}return Object(x.a)(t,e),Object(E.a)(t,[{key:\"changeInputValue\",value:function(e){this.props.updateHandler(this.props.header.index,e.target.name,e.target.value)}},{key:\"render\",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h.a.Group,{compact:!0,style:{width:\"90%\"}},l.a.createElement(h.a,{style:{width:\"20%\"},name:\"key\",value:this.props.header.key,onChange:this.changeInputValue,placeholder:\"User-Agent\"}),l.a.createElement(h.a,{style:{width:\"80%\"},name:\"value\",value:this.props.header.value,onChange:this.changeInputValue,placeholder:\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36\"})),this.props.showDeleteButton?l.a.createElement(B.a,{className:\"dynamic-delete-button color-red\",type:\"minus-circle-o\",style:{color:\"#ff6868\"},onClick:function(t){return e.props.deleteHandler(e.props.header.index)}}):null,this.props.showAddButton?l.a.createElement(B.a,{className:\"dynamic-delete-button color-grey\",type:\"plus-circle-o\",onClick:this.props.addHandler}):null)}}]),t}(l.a.Component),A=0,G=function e(){Object(b.a)(this,e),this.index=++A,this.key=\"\",this.value=\"\"};function _(e,t){for(var a in e)if(e[a].index===t)return a;return-1}var D=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={pathHelp:{status:\"success\",help:\"\"},headersHelp:{status:\"success\",help:\"\"}},a.changeInputValue=a.changeInputValue.bind(Object(C.a)(a)),a.changeInputValueByName=a.changeInputValueByName.bind(Object(C.a)(a)),a.addHeader=a.addHeader.bind(Object(C.a)(a)),a.updateHeader=a.updateHeader.bind(Object(C.a)(a)),a.deleteHeader=a.deleteHeader.bind(Object(C.a)(a)),a}return Object(x.a)(t,e),Object(E.a)(t,[{key:\"checkRule\",value:function(e,t){var a;if(\"path\"===e)a=t.startsWith(\"/\")?{status:\"success\",help:\"\"}:{status:\"error\",help:\"path\\u9700\\u8981\\u4ee5/\\u5f00\\u5934\"},this.setState({pathHelp:a});else if(\"headers\"===e){var n={status:\"success\",help:\"\"},l=!0,r=!1,s=void 0;try{for(var o,c=t[Symbol.iterator]();!(l=(o=c.next()).done);l=!0){o.value.key||(n={status:\"error\",help:\"HTTP\\u5934Key\\u4e0d\\u80fd\\u4e3a\\u7a7a\"})}}catch(i){r=!0,s=i}finally{try{l||null==c.return||c.return()}finally{if(r)throw s}}this.setState({headersHelp:n})}}},{key:\"changeInputValue\",value:function(e){this.checkRule(e.target.name,e.target.value),this.props.updateHandler(this.props.rule.index,e.target.name,e.target.value)}},{key:\"changeInputValueByName\",value:function(e,t){this.checkRule(e,t),this.props.updateHandler(this.props.rule.index,e,t)}},{key:\"addHeader\",value:function(){var e=H()(this.props.rule.headers,{$push:[new G]});this.changeInputValueByName(\"headers\",e)}},{key:\"updateHeader\",value:function(e,t,a){var n=_(this.props.rule.headers,e);if(n>=0){var l=H()(this.props.rule.headers,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.changeInputValueByName(\"headers\",l)}}},{key:\"deleteHeader\",value:function(e){var t=_(this.props.rule.headers,e);if(t>=0){var a=H()(this.props.rule.headers,{$splice:[[t,1]]});this.changeInputValueByName(\"headers\",a)}}},{key:\"render\",value:function(){var e=this;return l.a.createElement(S.a,{title:\"\\u89c4\\u5219\\uff08Rule\\uff09\",size:\"small\",className:\"rule-card\",style:{marginBottom:\"24px\"},extra:l.a.createElement(i.a.Group,{size:\"small\"},l.a.createElement(i.a,{onClick:function(t){return e.props.deleteHandler(e.props.rule.index)},disabled:this.props.ruleSize<=1},\"\\u5220\\u9664Rule\"),l.a.createElement(i.a,{onClick:this.props.addHandler},\"\\u589e\\u52a0\\u4e00\\u4e2aRule\"))},l.a.createElement(p.a.Item,{label:\"\\u8bf7\\u6c42\\u65b9\\u6cd5\",className:\"rule-item\"},l.a.createElement(u.a,{defaultValue:this.props.rule.method,style:{width:120},name:\"method\",onChange:function(t){return e.changeInputValueByName(\"method\",t)}},[\"HEAD\",\"GET\",\"POST\",\"PUT\",\"PATCH\",\"DELETE\",\"CONNECT\",\"OPTIONS\",\"TRACE\"].map(function(e,t){return l.a.createElement(u.a.Option,{value:e,key:e},e)}))),l.a.createElement(p.a.Item,{label:\"\\u8bf7\\u6c42\\u8def\\u5f84\",className:\"rule-item\",validateStatus:this.state.pathHelp.status,help:this.state.pathHelp.help},l.a.createElement(h.a,{placeholder:\"/path/to/request\",type:\"text\",name:\"path\",value:this.props.rule.path,onChange:this.changeInputValue})),l.a.createElement(p.a.Item,{label:\"\\u8bf7\\u6c42\\u5934\",className:\"rule-item\",validateStatus:this.state.headersHelp.status,help:this.state.headersHelp.help},this.props.rule.headers.map(function(t,a){return l.a.createElement(z,{key:t.index,header:t,showAddButton:a===e.props.rule.headers.length-1,showDeleteButton:e.props.rule.headers.length>1,addHandler:e.addHeader,updateHandler:e.updateHeader,deleteHandler:e.deleteHeader})})),l.a.createElement(p.a.Item,{label:\"\\u8bf7\\u6c42\\u4f53\",className:\"rule-item\"},l.a.createElement(h.a.TextArea,{autosize:{minRows:2},name:\"body\",value:this.props.rule.body,onChange:this.changeInputValue})),l.a.createElement(p.a.Item,{label:\"\\u5141\\u8bb8\\u8df3\\u8f6c\",className:\"rule-item\"},l.a.createElement(T.a,{checked:this.props.rule.follow_redirects,name:\"follow_redirects\",onChange:function(t){return e.changeInputValueByName(\"follow_redirects\",t)}})),l.a.createElement(p.a.Item,{label:\"CEL\\u8868\\u8fbe\\u5f0f\",className:\"rule-item\"},l.a.createElement(h.a,{placeholder:\"responese.status==200\",type:\"text\",value:this.props.rule.expression,name:\"expression\",onChange:this.changeInputValue})),l.a.createElement(p.a.Item,{label:\"\\u63d0\\u53d6\\u89c4\\u5219\",className:\"rule-item\"},l.a.createElement(h.a,{placeholder:\"\",type:\"text\",value:this.props.rule.search,name:\"search\",onChange:this.changeInputValue})))}}]),t}(l.a.Component),W=0,$=function(){function e(){Object(b.a)(this,e),this.index=++W,this.method=\"GET\",this.path=\"\",this.headers=[new G],this.body=\"\",this.follow_redirects=!0,this.expression=\"\",this.search=\"\"}return Object(E.a)(e,[{key:\"addHeader\",value:function(){}}]),e}(),q=k.a.Header,K=k.a.Content,L=k.a.Footer,M=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={name:\"poc-yaml-sql\",transport:\"http\",rules:[new $],detail:{},poc:\"\"},a.updateRule=a.updateRule.bind(Object(C.a)(a)),a.generatePOC=a.generatePOC.bind(Object(C.a)(a)),a.addRule=a.addRule.bind(Object(C.a)(a)),a.deleteRule=a.deleteRule.bind(Object(C.a)(a)),a.notify=a.notify.bind(Object(C.a)(a)),a}return Object(x.a)(t,e),Object(E.a)(t,[{key:\"componentDidMount\",value:function(){var e=this;new V.a(\"#copy-btn\").on(\"success\",function(t){e.notify(\"\\u590d\\u5236\\u6210\\u529f\",\"POC\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u590d\\u5236\\u5230\\u526a\\u5207\\u677f\")})}},{key:\"notify\",value:function(e,t){v.a.success({message:e,description:t,duration:3})}},{key:\"updateRule\",value:function(e,t,a){var n=_(this.state.rules,e);if(n>=0){var l=H()(this.state.rules,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.setState({rules:l})}}},{key:\"deleteRule\",value:function(e){var t=_(this.state.rules,e);if(t>=0){var a=H()(this.state.rules,{$splice:[[t,1]]});this.setState({rules:a})}}},{key:\"generatePOC\",value:function(){var e={name:this.state.name,transport:this.state.transport,rules:N()(this.state.rules)},t=!0,a=!1,n=void 0;try{for(var l,r=e.rules[Symbol.iterator]();!(t=(l=r.next()).done);t=!0){var s=l.value;delete s.index;var o={},c=!0,i=!1,u=void 0;try{for(var d,p=s.headers[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;h.key&&(o[h.key]=h.value)}}catch(b){i=!0,u=b}finally{try{c||null==p.return||p.return()}finally{if(i)throw u}}Object.keys(o).length>0?s.headers=o:delete s.headers,s.body.length||delete s.body,s.path.length||delete s.path,s.search.length||delete s.search,s.expression=\"\".concat(s.expression,\"\\n\");var m,y={};y.method=s.method,y.follow_redirects=s.follow_redirects,y.body=s.body,y.path=s.path,m=s.expression,delete s.method,delete s.follow_redirects,delete s.body,delete s.path,delete s.expression,s.request=y,s.expression=m}}catch(b){a=!0,n=b}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}var f={};e.rules.forEach(function(e,t){f[\"r\".concat(t)]=e});var v=I.a.safeDump({name:this.state.name,transport:this.state.transport,rules:f,expression:Object.values(f).reduce(function(e,t,a){return 0===a?\"\".concat(t.name,\"()\"):1===a?\"\".concat(e,\"&&\").concat(t.name,\"()\"):\"\".concat(e,\"&&(\").concat(t.name,\"())\")},\"\")});this.setState({poc:v})}},{key:\"addRule\",value:function(){var e=H()(this.state.rules,{$push:[new $]});this.setState({rules:e})}},{key:\"render\",value:function(){var e=this;return l.a.createElement(k.a,{className:\"layout\"},l.a.createElement(q,null,l.a.createElement(\"div\",{className:\"logo\"},l.a.createElement(\"span\",{role:\"img\",\"aria-label\":\"dna\",\"aria-hidden\":\"true\"},\"\\ud83e\\uddec\"),\" Comal POC Generation\"),l.a.createElement(y.b,{theme:\"dark\",mode:\"horizontal\",defaultSelectedKeys:[\"2\"],style:{lineHeight:\"64px\"}})),l.a.createElement(K,{style:{padding:\"0 50px\"}},l.a.createElement(m.a,{style:{margin:\"16px 0\"}},l.a.createElement(m.a.Item,null,\"\\u9996\\u9875\"),l.a.createElement(m.a.Item,null,\"POC\\u751f\\u6210\")),l.a.createElement(\"div\",{style:{background:\"#fff\",padding:24,minHeight:280}},l.a.createElement(c.a,{gutter:16,type:\"flex\"},l.a.createElement(d.a,{span:12},l.a.createElement(p.a,{layout:\"horizontal\",labelAlign:\"left\"},l.a.createElement(p.a.Item,Object.assign({label:\"POC\\u540d\"},{labelCol:{span:2},wrapperCol:{span:22}}),l.a.createElement(h.a,{placeholder:\"\\u7531\\u6570\\u5b57\\u3001\\u5b57\\u6bcd\\u3001\\u77ed\\u6a2a\\u7ebf\\u7ec4\\u6210\",type:\"text\",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),this.state.rules.map(function(t,a){return l.a.createElement(D,{key:t.index,rule:t,ruleSize:e.state.rules.length,updateHandler:e.updateRule,addHandler:e.addRule,deleteHandler:e.deleteRule})}))),l.a.createElement(d.a,{span:12,style:{paddingTop:\"4px\"}},l.a.createElement(o.a,{offsetTop:8},l.a.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\"}},l.a.createElement(\"div\",{style:{marginBottom:\"15px\"}},l.a.createElement(\"span\",{style:{fontSize:\"18px\",fontWeight:\"bold\"}},\"\\u8bf7\\u9009\\u62e9\\u53c2\\u8003\\u6a21\\u677f\"),l.a.createElement(\"br\",null),l.a.createElement(u.a,{placeholder:\"\\u9009\\u62e9\\u751f\\u6210\\u7684POC\\u5185\\u5bb9\",value:this.state.selectedPOC,style:{width:\"100%\"},onChange:function(t){return e.setState({selectedPOC:t})}},l.a.createElement(u.a.Option,{value:\"poc1\"},\"poc-yaml-sql\"),l.a.createElement(u.a.Option,{value:\"poc2\"},\"poc-yaml-xss\"),l.a.createElement(u.a.Option,{value:\"poc3\"},\"poc-yaml-lfi\"),l.a.createElement(u.a.Option,{value:\"poc4\"},\"poc-yaml-rce\"),l.a.createElement(u.a.Option,{value:\"poc5\"},\"poc-yaml-leak\"),l.a.createElement(u.a.Option,{value:\"poc6\"},\"poc-yaml-rce\"))),l.a.createElement(\"div\",null,l.a.createElement(h.a.TextArea,{autosize:{minRows:10},placeholder:\"\\u6839\\u636e\\u9009\\u62e9\\u751f\\u6210\\u7684POC\\u5185\\u5bb9\",value:\"poc1\"===this.state.selectedPOC?'name: poc-yaml-sql\\nrules:\\n  - method: GET\\n    path: /url\\n    body: alert(\"xss\")\\n    follow_redirects: true\\n    expression: |+':\"poc2\"===this.state.selectedPOC?\"poc2\\u7684\\u5185\\u5bb9\":\"poc3\"===this.state.selectedPOC?\"poc3\\u7684\\u5185\\u5bb9\":\"poc4\"===this.state.selectedPOC?\"poc4\\u7684\\u5185\\u5bb9\":\"poc5\"===this.state.selectedPOC?\"poc5\\u7684\\u5185\\u5bb9\":\"poc6\"===this.state.selectedPOC?\"poc6\\u7684\\u5185\\u5bb9\":\"\",readOnly:!0})),l.a.createElement(\"div\",null,l.a.createElement(h.a.TextArea,{autosize:{minRows:10},placeholder:\"\\u751f\\u6210POC\\u5185\\u5bb9\",value:this.state.poc,id:\"poc-detail\",readOnly:!1})),l.a.createElement(c.a,{justify:\"end\",type:\"flex\"},l.a.createElement(i.a,{type:\"primary\",size:\"default\",onClick:this.generatePOC,className:\"br\"},\"\\u751f\\u6210\"),l.a.createElement(i.a,{type:\"dashed\",icon:\"copy\",id:\"copy-btn\",\"data-clipboard-text\":this.state.poc},\"\\u590d\\u5236POC\")))))))),l.a.createElement(L,{style:{textAlign:\"center\"}},\"\\xa92023 Comal POC Generation\"))}}]),t}(l.a.Component);Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(M,null),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[187,1,2]]]);","extractedComments":[]}