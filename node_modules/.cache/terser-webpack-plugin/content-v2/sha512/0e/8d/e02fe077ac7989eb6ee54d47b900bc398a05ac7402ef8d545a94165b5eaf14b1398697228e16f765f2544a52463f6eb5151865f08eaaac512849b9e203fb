{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){e.exports=a(392)},193:function(e,t,a){},392:function(e,t,a){\"use strict\";a.r(t);var n=a(1),l=a.n(n),r=a(8),s=a.n(r),i=(a(192),a(193),a(194),a(184)),u=(a(130),a(44)),c=(a(83),a(34)),o=(a(106),a(33)),d=(a(131),a(27)),h=(a(132),a(36)),p=(a(166),a(45)),m=(a(393),a(104)),y=(a(167),a(79)),f=a(66),v=(a(206),a(183)),b=a(37),g=a(49),E=a(65),O=a(60),k=a(24),H=a(64),C=(a(208),a(81)),x=a(50),j=a.n(x),w=a(168),I=a.n(w),N=a(169),R=a.n(N),V=a(170),S=a.n(V),T=(a(394),a(182)),B=(a(237),a(180)),P=(a(239),a(10)),A=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).changeInputValue=a.changeInputValue.bind(Object(k.a)(a)),a}return Object(H.a)(t,e),Object(g.a)(t,[{key:\"changeInputValue\",value:function(e){this.props.updateHandler(this.props.header.index,e.target.name,e.target.value)}},{key:\"render\",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(o.a.Group,{compact:!0,style:{width:\"90%\"}},l.a.createElement(o.a,{style:{width:\"20%\"},name:\"key\",value:this.props.header.key,onChange:this.changeInputValue,placeholder:\"User-Agent\"}),l.a.createElement(o.a,{style:{width:\"80%\"},name:\"value\",value:this.props.header.value,onChange:this.changeInputValue,placeholder:\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36\"})),this.props.showDeleteButton?l.a.createElement(P.a,{className:\"dynamic-delete-button color-red\",type:\"minus-circle-o\",style:{color:\"#ff6868\"},onClick:function(t){return e.props.deleteHandler(e.props.header.index)}}):null,this.props.showAddButton?l.a.createElement(P.a,{className:\"dynamic-delete-button color-grey\",type:\"plus-circle-o\",onClick:this.props.addHandler}):null)}}]),t}(l.a.Component),z=0,G=function e(){Object(b.a)(this,e),this.index=++z,this.key=\"\",this.value=\"\"};function $(e,t){for(var a in e)if(e[a].index===t)return a;return-1}var D=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).state={pathHelp:{status:\"success\",help:\"\"},headersHelp:{status:\"success\",help:\"\"}},a.changeInputValue=a.changeInputValue.bind(Object(k.a)(a)),a.changeInputValueByName=a.changeInputValueByName.bind(Object(k.a)(a)),a.addHeader=a.addHeader.bind(Object(k.a)(a)),a.updateHeader=a.updateHeader.bind(Object(k.a)(a)),a.deleteHeader=a.deleteHeader.bind(Object(k.a)(a)),a}return Object(H.a)(t,e),Object(g.a)(t,[{key:\"checkRule\",value:function(e,t){var a;if(\"path\"===e)a=t.startsWith(\"/\")?{status:\"success\",help:\"\"}:{status:\"error\",help:\"path\\u9700\\u8981\\u4ee5/\\u5f00\\u5934\"},this.setState({pathHelp:a});else if(\"headers\"===e){var n={status:\"success\",help:\"\"},l=!0,r=!1,s=void 0;try{for(var i,u=t[Symbol.iterator]();!(l=(i=u.next()).done);l=!0){i.value.key||(n={status:\"error\",help:\"HTTP\\u5934Key\\u4e0d\\u80fd\\u4e3a\\u7a7a\"})}}catch(c){r=!0,s=c}finally{try{l||null==u.return||u.return()}finally{if(r)throw s}}this.setState({headersHelp:n})}}},{key:\"changeInputValue\",value:function(e){this.checkRule(e.target.name,e.target.value),this.props.updateHandler(this.props.rule.index,e.target.name,e.target.value)}},{key:\"changeInputValueByName\",value:function(e,t){this.checkRule(e,t),this.props.updateHandler(this.props.rule.index,e,t)}},{key:\"addHeader\",value:function(){var e=j()(this.props.rule.headers,{$push:[new G]});this.changeInputValueByName(\"headers\",e)}},{key:\"updateHeader\",value:function(e,t,a){var n=$(this.props.rule.headers,e);if(n>=0){var l=j()(this.props.rule.headers,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.changeInputValueByName(\"headers\",l)}}},{key:\"deleteHeader\",value:function(e){var t=$(this.props.rule.headers,e);if(t>=0){var a=j()(this.props.rule.headers,{$splice:[[t,1]]});this.changeInputValueByName(\"headers\",a)}}},{key:\"render\",value:function(){var e=this;return l.a.createElement(T.a,{title:\"\\u89c4\\u5219\\uff08Rule\\uff09\",size:\"small\",className:\"rule-card\",style:{marginBottom:\"24px\"},extra:l.a.createElement(c.a.Group,{size:\"small\"},l.a.createElement(c.a,{onClick:function(t){return e.props.deleteHandler(e.props.rule.index)},disabled:this.props.ruleSize<=1},\"\\u5220\\u9664Rule\"),l.a.createElement(c.a,{onClick:this.props.addHandler},\"\\u589e\\u52a0\\u4e00\\u4e2aRule\"))},l.a.createElement(h.a.Item,{label:\"\\u8bf7\\u6c42\\u65b9\\u6cd5\",className:\"rule-item\"},l.a.createElement(p.a,{defaultValue:this.props.rule.method,style:{width:120},name:\"method\",onChange:function(t){return e.changeInputValueByName(\"method\",t)}},[\"HEAD\",\"GET\",\"POST\",\"PUT\",\"PATCH\",\"DELETE\",\"CONNECT\",\"OPTIONS\",\"TRACE\"].map(function(e,t){return l.a.createElement(p.a.Option,{value:e,key:e},e)}))),l.a.createElement(h.a.Item,{label:\"\\u8bf7\\u6c42\\u8def\\u5f84\",className:\"rule-item\",validateStatus:this.state.pathHelp.status,help:this.state.pathHelp.help},l.a.createElement(o.a,{placeholder:\"/path/to/request\",type:\"text\",name:\"path\",value:this.props.rule.path,onChange:this.changeInputValue})),l.a.createElement(h.a.Item,{label:\"\\u8bf7\\u6c42\\u5934\",className:\"rule-item\",validateStatus:this.state.headersHelp.status,help:this.state.headersHelp.help},this.props.rule.headers.map(function(t,a){return l.a.createElement(A,{key:t.index,header:t,showAddButton:a===e.props.rule.headers.length-1,showDeleteButton:e.props.rule.headers.length>1,addHandler:e.addHeader,updateHandler:e.updateHeader,deleteHandler:e.deleteHeader})})),l.a.createElement(h.a.Item,{label:\"\\u8bf7\\u6c42\\u4f53\",className:\"rule-item\"},l.a.createElement(o.a.TextArea,{autosize:{minRows:2},name:\"body\",value:this.props.rule.body,onChange:this.changeInputValue})),l.a.createElement(h.a.Item,{label:\"\\u5141\\u8bb8\\u8df3\\u8f6c\",className:\"rule-item\"},l.a.createElement(B.a,{checked:this.props.rule.follow_redirects,name:\"follow_redirects\",onChange:function(t){return e.changeInputValueByName(\"follow_redirects\",t)}})),l.a.createElement(h.a.Item,{label:\"CEL\\u8868\\u8fbe\\u5f0f\",className:\"rule-item\"},l.a.createElement(o.a,{placeholder:\"status==200\",type:\"text\",value:this.props.rule.expression,name:\"expression\",onChange:this.changeInputValue})),l.a.createElement(h.a.Item,{label:\"\\u63d0\\u53d6\\u89c4\\u5219\",className:\"rule-item\"},l.a.createElement(o.a,{placeholder:\"\",type:\"text\",value:this.props.rule.search,name:\"search\",onChange:this.changeInputValue})))}}]),t}(l.a.Component),W=0,K=function(){function e(){Object(b.a)(this,e),this.index=++W,this.method=\"GET\",this.path=\"\",this.headers=[new G],this.body=\"\",this.follow_redirects=!0,this.expression=\"\",this.search=\"\"}return Object(g.a)(e,[{key:\"addHeader\",value:function(){}}]),e}(),_=C.a.Header,q=C.a.Content,L=C.a.Footer,M=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).state={name:\"poc-yaml-sql\",rules:[new K],detail:{},poc:\"\"},a.updateRule=a.updateRule.bind(Object(k.a)(a)),a.generatePOC=a.generatePOC.bind(Object(k.a)(a)),a.addRule=a.addRule.bind(Object(k.a)(a)),a.deleteRule=a.deleteRule.bind(Object(k.a)(a)),a.notify=a.notify.bind(Object(k.a)(a)),a}return Object(H.a)(t,e),Object(g.a)(t,[{key:\"componentDidMount\",value:function(){var e=this;new S.a(\"#copy-btn\").on(\"success\",function(t){e.notify(\"\\u590d\\u5236\\u6210\\u529f\",\"POC\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u590d\\u5236\\u5230\\u526a\\u5207\\u677f\")})}},{key:\"notify\",value:function(e,t){v.a.success({message:e,description:t,duration:3})}},{key:\"updateRule\",value:function(e,t,a){var n=$(this.state.rules,e);if(n>=0){var l=j()(this.state.rules,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.setState({rules:l})}}},{key:\"deleteRule\",value:function(e){var t=$(this.state.rules,e);if(t>=0){var a=j()(this.state.rules,{$splice:[[t,1]]});this.setState({rules:a})}}},{key:\"generatePOC\",value:function(){var e={name:this.state.name,rules:R()(this.state.rules)},t=!0,a=!1,n=void 0;try{for(var l,r=e.rules[Symbol.iterator]();!(t=(l=r.next()).done);t=!0){var s=l.value;delete s.index;var i={},u=!0,c=!1,o=void 0;try{for(var d,h=s.headers[Symbol.iterator]();!(u=(d=h.next()).done);u=!0){var p=d.value;p.key&&(i[p.key]=p.value)}}catch(y){c=!0,o=y}finally{try{u||null==h.return||h.return()}finally{if(c)throw o}}Object.keys(i).length>0?s.headers=i:delete s.headers,s.body.length||delete s.body,s.path.length||delete s.path,s.search.length||delete s.search,s.expression=\"\".concat(s.expression,\"\\n\")}}catch(y){a=!0,n=y}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}var m=I.a.safeDump(e);this.setState({poc:m})}},{key:\"addRule\",value:function(){var e=j()(this.state.rules,{$push:[new K]});this.setState({rules:e})}},{key:\"render\",value:function(){var e=this;return l.a.createElement(C.a,{className:\"layout\"},l.a.createElement(_,null,l.a.createElement(\"div\",{className:\"logo\"},l.a.createElement(\"span\",{role:\"img\",\"aria-label\":\"dna\",\"aria-hidden\":\"true\"},\"\\ud83e\\uddec\"),\" Comal POC Generation\"),l.a.createElement(y.b,{theme:\"dark\",mode:\"horizontal\",defaultSelectedKeys:[\"2\"],style:{lineHeight:\"64px\"}})),l.a.createElement(q,{style:{padding:\"0 50px\"}},l.a.createElement(m.a,{style:{margin:\"16px 0\"}},l.a.createElement(m.a.Item,null,\"\\u9996\\u9875\"),l.a.createElement(m.a.Item,null,\"POC\\u751f\\u6210\")),l.a.createElement(\"div\",{style:{background:\"#fff\",padding:24,minHeight:280}},l.a.createElement(u.a,{gutter:16,type:\"flex\"},l.a.createElement(d.a,{span:12},l.a.createElement(h.a,{layout:\"horizontal\",labelAlign:\"left\"},l.a.createElement(h.a.Item,Object.assign({label:\"POC\\u540d\"},{labelCol:{span:2},wrapperCol:{span:22}}),l.a.createElement(p.a,{placeholder:\"\\u8bf7\\u9009\\u62e9\\u6216\\u8f93\\u5165\\u540d\\u79f0\",value:this.state.name,onChange:function(t){return e.setState({name:t})}},l.a.createElement(p.a.Option,{value:\"poc1\"},\"poc-yaml-sql\"),l.a.createElement(p.a.Option,{value:\"poc2\"},\"poc-yaml-xss\"),l.a.createElement(p.a.Option,{value:\"poc3\"},\"poc-yaml-lfi\"),l.a.createElement(p.a.Option,{value:\"poc4\"},\"poc-yaml-rce\"))),this.state.rules.map(function(t,a){return l.a.createElement(D,{key:t.index,rule:t,ruleSize:e.state.rules.length,updateHandler:e.updateRule,addHandler:e.addRule,deleteHandler:e.deleteRule})}))),l.a.createElement(d.a,{span:12,style:{paddingTop:\"4px\"}},l.a.createElement(i.a,{offsetTop:8},l.a.createElement(o.a.TextArea,{autosize:{minRows:20},placeholder:\"\\u751f\\u6210POC\\u5185\\u5bb9\",value:this.state.poc,id:\"poc-detail\",readOnly:!0,style:{marginBottom:\"15px\"}}),l.a.createElement(u.a,{justify:\"end\",type:\"flex\"},l.a.createElement(c.a,{type:\"primary\",size:\"default\",onClick:this.generatePOC,className:\"br\"},\"\\u751f\\u6210\"),l.a.createElement(c.a,{type:\"dashed\",icon:\"copy\",id:\"copy-btn\",\"data-clipboard-text\":this.state.poc},\"\\u590d\\u5236POC\"))))))),l.a.createElement(L,{style:{textAlign:\"center\"}},\"\\xa92023 Comal POC Generation\"))}}]),t}(l.a.Component);Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(M,null),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[187,1,2]]]);","extractedComments":[]}